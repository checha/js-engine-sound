<html>
	<head>
		<script type="text/javascript" src="jquery.min.js"></script>
		<script type="text/javascript" src="js-engine-sound.js"></script>
		<script type="text/javascript">
			$(document).ready(function() {
				
				/*
				var audio = null;
				var url = 'newachievement1.mp3';
				
				var track = {};
			
				// create
				audio = new Audio(url);
				
				audio.muted = true;
				
				// preload
				var force = function () {
  					audio.pause();
  					audio.removeEventListener('play', force, false);
				};
				audio.addEventListener('play', force, false);

				var click = document.ontouchstart === undefined ? 'click' : 'touchstart';
				var kickoff = function () {
  					audio.play();
  					audio.muted = true;
  					document.documentElement.removeEventListener(click, kickoff, true);
  					console.log('click');
				};
				document.documentElement.addEventListener(click, kickoff, true);
				
				//var progress = function () {
    			//	audio.removeEventListener('progress', progress, false);
    			//	if (track.updateCallback !== null) track.updateCallback();
  				//};
				//audio.addEventListener('progress', progress, false);
				
				
				
				
				
			
				// controls
				$(document.body).append($('<div class="button">play 1</div>').bind('click', function() {
					audio.currenttime = 1;
					//audio.muted = false;
					audio.play();
				}));
				$(document.body).append($('<div class="button">play 2</div>').bind('click', function() {
					
				}));
				*/
			
			
			
			
			
			
			
			
			
			
			
			
			
			
				//var sound = new SoundSafari({url:'newachievement1.mp3'});
			
				/*
				var sd = new listSounds();
				sd.add(['android2.mp3','android2.ogg'], 'sound1', function(err) {console.log('Error: '+err)});
				
				//setTimeout(function() {sd.play('sound1');}, 1000);
				
				//console.log(typeof Audio);
				//$(document).bind('click',function(e) {console.log(typeof Audio);});
				
				$(document.body).append($('<div class="button">play</div>').bind('click', function() {sd.play('sound1');}));
				$(document.body).append($('<div class="button">stop</div>').bind('click', function() {sd.stop('sound1');}));
				$(document.body).append($('<div class="button"><span>stopPlay</span></div>').bind('mouseover', function() {
					sd.stopPlay('sound1');
					sd.mute('sound1',true);
				}));
				$('.button > span').bind('click', function() {
					sd.pos('sound1');
					sd.mute('sound1', false);
				});
				//$(document.body).append($('<div class="button">stopPlay</div>'));
				*/

				document.body.style.backgroundColor = 'red';



function Track(src, spriteLength, audioLead) {
  var track = this,
      audio = document.createElement('audio');
  audio.src = src;
  audio.autobuffer = true;
  audio.load();
  audio.muted = true; // makes no difference on iOS :(
  

  var force = function () {
    audio.pause();
    audio.removeEventListener('play', force, false);
    console.log('click');
  };
  
  var progress = function () {
    audio.removeEventListener('progress', progress, false);
    if (track.updateCallback !== null) track.updateCallback();
  };
  
  audio.addEventListener('play', force, false);
  audio.addEventListener('progress', progress, false);
  
  var click = document.ontouchstart === undefined ? 'click' : 'touchstart';
  
  var kickoff = function () {
    audio.play();
    document.documentElement.removeEventListener(click, kickoff, true);
  };
  
  document.documentElement.addEventListener(click, kickoff, true);
  
  this.updateCallback = null;
  this.audio = audio;
  this.playing = false;
  this.lastUsed = 0;
  this.spriteLength = spriteLength;
  this.audioLead = audioLead;
}
 
Track.prototype.play = function (position) {
  var track = this,
      audio = this.audio,
      lead = this.audioLead,
      length = this.spriteLength,
      time = lead + position * length,
      nextTime = time + length;
      
  clearInterval(track.timer);
  track.playing = true;
  track.lastUsed = +new Date;
  
  audio.muted = false;
  audio.pause();
  try {
    if (time == 0) time = 0.01; // yay hacks. Sometimes setting time to 0 doesn't play back
    audio.currentTime = time;
    audio.play();
  } catch (e) {
    this.updateCallback = function () {
      track.updateCallback = null;
      audio.currentTime = time;
      audio.play();
    };
    audio.play();
  }
 
  track.timer = setInterval(function () {
    if (audio.currentTime >= nextTime) {
      audio.pause();
      audio.muted = true;
      clearInterval(track.timer);
      player.playing = false;
    }
  }, 10);
};

//$(document.body).append($('<div class="button">play 2</div>').bind('click', function() {

var player = (function (src, n, spriteLength, audioLead) {
  var tracks = [],
      total = n,
      i;
  
  while (n--) {
    tracks.push(new Track(src, spriteLength, audioLead));
  }
  
  return {
    tracks: tracks,
    play: function (position) {
      var i = total,
          track = null;
          
      while (i--) {
        if (tracks[i].playing === false) {
          track = tracks[i];
          break;
        } else if (track === null || tracks[i].lastUsed < track.lastUsed) {
          track = tracks[i];
        }
      }
      
      if (track) {
        track.play(position);
      } else {
        // console.log('could not find a track to play :(');
      }
    }
  };
})('newachievement1.mp3', 1, 1, 0);

//}));

$(document.body).append($('<div class="button">play 1</div>').bind('click', function() {
	player.play(0);
}));

$(document.body).append($('<div class="button">play 01</div>').bind('click', function() {
	player.play(1);
}));


// str play
var au = new Audio('newachievement1.mp3');


$(document.body).append($('<div class="button">play 2</div>').bind('click', function() {
	au.play();
}));

			});
		</script>
		<style type="text/css">
			.button {
				display: inline-block;
				border: 1px solid black;
				padding: 50px 100px 50px 100px;
				cursor: pointer;
				margin-left: 5px;
			}
			.button > span {
				border: 1px solid black;
			}
		</style>
	</head>
	<body>
	</body>
</html>
